/**
 * Jenkinsfile
 *
 * Jenkins Pipeline to provision bare metal slaves in beaker.
 */
node ('jenkins-slave') {
    ansiColor('xterm') {
        timestamps {

            stage('Trigger') {
                // TODO Set triggers for Job Build
            }

            stage('Provision') {
                // TODO build an executable environment
                dir('ci-pipeline') {
                    git 'https://github.com/jaypoulz/multiarch-ci-pipeline'
                    sh 'cinchpin up'
                }
            }

            stage('Output') {
                dir('ci-pipeline') {
                    sh 'cat inventories/cinch.inventory'
                    sh 'cat resources/cinch.output'
                }
            }

            // TODO implement publishing process
            stage('Notify') {
                // TODO Kickoff Test
            }
        }
    }
}
